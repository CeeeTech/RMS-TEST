import{l as o,af as Ie,r as v,K as D,e as _,m as P,x as Q,y as K,a3 as Oe,Y as q,h as y,d6 as je,dh as U,bV as Pe,a9 as de,aa as he}from"./index-DRAxbQhQ.js";import{C as G,S as ue,I as ce,e as Re,c as fe,f as Me,g as $e,r as Ue,h as ge,i as We,j as Be,k as Ve,l as qe,m as Ge,n as He,o as Ye,p as Qe,q as Ke,s as Je,t as Xe,u as Ze,v as H,w as me,x as Y,y as et,z as tt,A as pe,B as it,T as rt,D as at,E as st,F as nt,R as lt,b as ve,a as ye,G as ot,H as dt,J as ht,K as ut,L as ct,M as ft,N as gt,O as mt,P as pt,d as vt}from"./random-generator-jINFx21d.js";import{u as yt,a as xt,j as bt,k as xe}from"./DataGrid-CjdGGDRX.js";import{T as be}from"./Tooltip-CFImnuRV.js";import{d as J}from"./Info-CAMojKk0.js";import{S as we}from"./Select-D4CpAZMw.js";import{M as Ce}from"./MenuItem-I_H4wdck.js";import{A as Se,a as _e}from"./Autocomplete-IOsgmMSK.js";import{I as Te}from"./InputBase-C10xFuq9.js";import{R as De}from"./Rating-BM9K3GlR.js";function wt(t){return t.value==null?"":o.jsx(Ie,{style:{backgroundColor:t.value.color},children:t.value.name.toUpperCase().substring(0,1)})}const Ct=v.memo(function(e){const{value:r}=e;return o.jsxs(D,{sx:{width:"100%",display:"flex",alignItems:"center","&  > img":{mr:.5,flexShrink:0,width:"20px"}},children:[o.jsx("img",{loading:"lazy",width:"20",src:`https://flagcdn.com/w20/${r.code.toLowerCase()}.png`,srcSet:`https://flagcdn.com/w40/${r.code.toLowerCase()}.png 2x`,alt:""}),o.jsx(D,{component:"span",sx:{overflow:"hidden",textOverflow:"ellipsis"},children:r.label})]})});function Le(t){return t.value==null?"":t.aggregation&&!t.aggregation.hasCellUnit?null:o.jsx(Ct,{value:t.value})}const St=_("a")({textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",color:"inherit"}),ke=v.memo(function(e){const r=i=>{i.preventDefault(),i.stopPropagation()};return o.jsx(St,{tabIndex:e.tabIndex,onClick:r,href:e.href,children:e.children})});function _t(t){return t.value==null?"":o.jsx(ke,{href:t.value,tabIndex:t.tabIndex,children:t.value})}function Fe(t){var e;const r=(e=t.value)!=null?e:"";return o.jsx(ke,{href:`mailto:${r}`,tabIndex:t.tabIndex,children:r})}const Tt=v.memo(function(e){const{value:r}=e;if(!r)return null;const i=r.toString(),a=i.slice(i.indexOf("(")+1,i.indexOf(")")),n=i.slice(0,i.indexOf("(")).trim();return o.jsxs(D,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[o.jsx("span",{children:n}),o.jsx(be,{title:a,children:o.jsx(J,{sx:{color:"#2196f3",alignSelf:"center",ml:"8px"}})})]})});function Dt(t){return o.jsx(Tt,{value:t.value})}const Lt=_("div")(({theme:t})=>({width:"100%",fontVariantNumeric:"tabular-nums","&.positive":{color:t.palette.mode==="light"?t.palette.success.dark:t.palette.success.light},"&.negative":{color:t.palette.mode==="light"?t.palette.error.dark:t.palette.error.light}}));function kt(t){return t<0?`(${Math.abs(t).toLocaleString()})`:t.toLocaleString()}const Ft=v.memo(function(e){const{value:r}=e;return o.jsx(Lt,{className:P(r>0&&"positive",r<0&&"negative"),children:kt(r)})});function Et(t){return t.value==null?"":o.jsx(Ft,{value:t.value})}const At=_("div")(({theme:t})=>({border:`1px solid ${(t.vars||t).palette.divider}`,position:"relative",overflow:"hidden",width:"100%",height:26,borderRadius:2})),Nt=_("div")({position:"absolute",lineHeight:"24px",width:"100%",display:"flex",justifyContent:"center"}),zt=_("div")({height:"100%","&.low":{backgroundColor:"#f44336"},"&.medium":{backgroundColor:"#efbb5aa3"},"&.high":{backgroundColor:"#088208a3"}}),It=v.memo(function(e){const{value:r}=e,i=r*100;return o.jsxs(At,{children:[o.jsx(Nt,{children:`${i.toLocaleString()} %`}),o.jsx(zt,{className:P(i<30&&"low",i>=30&&i<=70&&"medium",i>70&&"high"),style:{maxWidth:`${i}%`}})]})});function Ot(t){return t.value==null?"":t.aggregation&&!t.aggregation.hasCellUnit?null:o.jsx(It,{value:t.value})}const jt=v.memo(function(e){const{value:r}=e;return o.jsxs(D,{sx:{display:"flex",alignItems:"center",lineHeight:"24px",color:"text.secondary"},children:[o.jsx(De,{value:r,sx:{mr:1},readOnly:!0})," ",Math.round(Number(r)*10)/10]})});function Pt(t){return t.value==null?"":t.aggregation&&!t.aggregation.hasCellUnit?null:o.jsx(jt,{value:t.value})}var X={},Rt=K;Object.defineProperty(X,"__esModule",{value:!0});var Z=X.default=void 0,Mt=Rt(Q()),$t=o;Z=X.default=(0,Mt.default)((0,$t.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"ReportProblem");var ee={},Ut=K;Object.defineProperty(ee,"__esModule",{value:!0});var te=ee.default=void 0,Wt=Ut(Q()),Bt=o;te=ee.default=(0,Wt.default)((0,Bt.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6m6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26"}),"Autorenew");var ie={},Vt=K;Object.defineProperty(ie,"__esModule",{value:!0});var re=ie.default=void 0,qt=Vt(Q()),Gt=o;re=ie.default=(0,qt.default)((0,Gt.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"Done");const Ht=_(Oe)(({theme:t})=>({justifyContent:"left","& .icon":{color:"inherit"},"&.Open":{color:(t.vars||t).palette.info.dark,border:`1px solid ${(t.vars||t).palette.info.main}`},"&.Filled":{color:(t.vars||t).palette.success.dark,border:`1px solid ${(t.vars||t).palette.success.main}`},"&.PartiallyFilled":{color:(t.vars||t).palette.warning.dark,border:`1px solid ${(t.vars||t).palette.warning.main}`},"&.Rejected":{color:(t.vars||t).palette.error.dark,border:`1px solid ${(t.vars||t).palette.error.main}`}})),Yt=v.memo(t=>{const{status:e}=t;let r=null;e==="Rejected"?r=o.jsx(Z,{className:"icon"}):e==="Open"?r=o.jsx(J,{className:"icon"}):e==="PartiallyFilled"?r=o.jsx(te,{className:"icon"}):e==="Filled"&&(r=o.jsx(re,{className:"icon"}));let i=e;return e==="PartiallyFilled"&&(i="Partially Filled"),o.jsx(Ht,{className:e,icon:r,size:"small",label:i,variant:"outlined"})});function Qt(t){return t.value==null?"":o.jsx(Yt,{status:t.value})}const Kt=_("div")(({theme:t})=>({width:"100%",height:"100%",lineHeight:"100%",paddingRight:8,fontVariantNumeric:"tabular-nums",display:"flex",alignItems:"center",justifyContent:"flex-end","&.good":{backgroundColor:t.vars?`rgba(${t.vars.palette.success.mainChannel} /  0.3)`:q(t.palette.success.main,.3)},"&.bad":{backgroundColor:t.vars?`rgba(${t.vars.palette.error.mainChannel} /  0.3)`:q(t.palette.error.main,.3)}})),Jt=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),Xt=v.memo(function(e){const{value:r}=e;return o.jsx(Kt,{className:P(r>1e6&&"good",r<1e6&&"bad"),children:Jt.format(r)})});function Zt(t){return t.value==null?"":t.aggregation&&!t.aggregation.hasCellUnit?null:o.jsx(Xt,{value:t.value})}const ei=yt,ti=ei,F=xt,ii=_(Se)(({theme:t})=>({height:"100%",[`& .${_e.inputRoot}`]:y({},t.typography.body2,{padding:"1px 0",height:"100%","& input":{padding:"0 16px",height:"100%"}})}));function ri(t){const{id:e,value:r,field:i}=t,a=F(),n=v.useCallback(async(l,s)=>{await a.current.setEditCellValue({id:e,field:i,value:s.toUpperCase()},l),a.current.stopCellEditMode({id:e,field:i})},[a,i,e]);return o.jsx(ii,{value:r,onChange:n,options:G,autoHighlight:!0,fullWidth:!0,open:!0,disableClearable:!0,renderOption:(l,s)=>o.jsxs(D,y({component:"li",sx:{"& > img":{mr:1.5,flexShrink:0}}},l,{children:[o.jsx("img",{loading:"lazy",width:"20",src:`https://flagcdn.com/w20/${s.slice(0,-1).toLowerCase()}.png`,srcSet:`https://flagcdn.com/w40/${s.slice(0,-1).toLowerCase()}.png 2x`,alt:""}),s]})),renderInput:l=>o.jsx(Te,y({autoFocus:!0,fullWidth:!0,id:l.id,inputProps:y({},l.inputProps,{autoComplete:"new-password"})},l.InputProps))})}function ne(t){return o.jsx(ri,y({},t))}const ai=_(je)(({theme:t})=>({display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center",padding:0,borderRadius:0,[`& .${U.rail}`]:{height:"100%",backgroundColor:"transparent"},[`& .${U.track}`]:{height:"100%",transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter}),"&.low":{backgroundColor:"#f44336"},"&.medium":{backgroundColor:"#efbb5aa3"},"&.high":{backgroundColor:"#088208a3"}},[`& .${U.thumb}`]:{height:"100%",width:5,borderRadius:0,marginTop:0,backgroundColor:q("#000000",.2)}}));function si(t){const{children:e,open:r,value:i}=t;return o.jsx(be,{open:r,enterTouchDelay:0,placement:"top",title:i,children:e})}function ni(t){const{id:e,value:r,field:i}=t,[a,n]=v.useState(Number(r)),l=F(),s=v.useCallback(f=>{l.current.setEditCellValue({id:e,field:i,value:f})},[l,i,e]),u=v.useMemo(()=>Pe(s,60),[s]),h=(f,c)=>{n(c),u(c)};v.useEffect(()=>{n(Number(r))},[r]);const d=f=>{f&&f.querySelector('[type="range"]').focus()};return o.jsx(ai,{ref:d,classes:{track:P(a<.3&&"low",a>=.3&&a<=.7&&"medium",a>.7&&"high")},value:a,max:1,step:1e-5,onChange:h,components:{ValueLabel:si},valueLabelDisplay:"auto",valueLabelFormat:f=>`${(f*100).toLocaleString()} %`})}function li(t){return o.jsx(ni,y({},t))}function oi(t){const{id:e,value:r,field:i}=t,a=ti(),n=F(),l=async u=>{await n.current.setEditCellValue({id:e,field:i,value:u.target.value})&&a.editMode===bt.Cell&&n.current.stopCellEditMode({id:e,field:i,cellToFocusAfter:"below"})},s=(u,h)=>{h==="backdropClick"&&n.current.stopCellEditMode({id:e,field:i,ignoreModifications:!0})};return o.jsx(we,{value:r,onChange:l,MenuProps:{onClose:s},sx:{height:"100%","& .MuiSelect-select":{display:"flex",alignItems:"center",pl:1}},autoFocus:!0,fullWidth:!0,open:!0,children:ue.map(u=>{let h=null;u==="Rejected"?h=Z:u==="Open"?h=J:u==="PartiallyFilled"?h=te:u==="Filled"&&(h=re);let d=u;return u==="PartiallyFilled"&&(d="Partially Filled"),o.jsxs(Ce,{value:u,children:[o.jsx(de,{sx:{minWidth:36},children:o.jsx(h,{fontSize:"small"})}),o.jsx(he,{primary:d,sx:{overflow:"hidden"}})]},u)})})}function di(t){return o.jsx(oi,y({},t))}function hi(t){const{id:e,value:r,field:i}=t,a=F(),n=async s=>{await a.current.setEditCellValue({id:e,field:i,value:s.target.value},s),a.current.stopCellEditMode({id:e,field:i})},l=(s,u)=>{u==="backdropClick"&&a.current.stopCellEditMode({id:e,field:i})};return o.jsx(we,{value:r,onChange:n,MenuProps:{onClose:l},sx:{height:"100%","& .MuiSelect-select":{display:"flex",alignItems:"center",pl:1}},autoFocus:!0,fullWidth:!0,open:!0,children:ce.map(s=>{const u=s.slice(s.indexOf("(")+1,s.indexOf(")")),h=s.slice(0,s.indexOf("(")).trim();return o.jsxs(Ce,{value:s,children:[o.jsx(de,{sx:{minWidth:36},children:h}),o.jsx(he,{primary:u,sx:{overflow:"hidden"}})]},s)})})}function ui(t){return o.jsx(hi,y({},t))}function ci(t){const{id:e,value:r,field:i}=t,a=F(),n=async s=>{await a.current.setEditCellValue({id:e,field:i,value:Number(s.target.value)},s),a.current.stopCellEditMode({id:e,field:i})},l=s=>{s&&s.querySelector(`input[value="${r}"]`).focus()};return o.jsxs(D,{sx:{display:"flex",alignItems:"center",lineHeight:"24px",color:"text.secondary",mr:1},children:[o.jsx(De,{ref:l,name:"rating",value:Number(r),precision:1,onChange:n,sx:{mr:1}}),Number(r)]})}function fi(t){return o.jsx(ci,y({},t))}const gi=_(Se)(({theme:t})=>({height:"100%",[`& .${_e.inputRoot}`]:y({},t.typography.body2,{padding:"1px 0",height:"100%","& input":{padding:"0 16px",height:"100%"}})}));function mi(t){const{id:e,value:r,field:i}=t,a=F(),n=v.useCallback(async(l,s)=>{await a.current.setEditCellValue({id:e,field:i,value:s},l),a.current.stopCellEditMode({id:e,field:i})},[a,i,e]);return o.jsx(gi,{value:r,onChange:n,options:Re,getOptionLabel:l=>l.label,autoHighlight:!0,fullWidth:!0,open:!0,disableClearable:!0,renderOption:(l,s)=>o.jsxs(D,y({component:"li",sx:{"& > img":{mr:1.5,flexShrink:0}}},l,{children:[o.jsx("img",{loading:"lazy",width:"20",src:`https://flagcdn.com/w20/${s.code.toLowerCase()}.png`,srcSet:`https://flagcdn.com/w40/${s.code.toLowerCase()}.png 2x`,alt:""}),s.label]})),renderInput:l=>o.jsx(Te,y({autoFocus:!0,fullWidth:!0,id:l.id,inputProps:y({},l.inputProps,{autoComplete:"new-password"})},l.InputProps))})}function pi(t){return o.jsx(mi,y({},t))}function Ee({work:t,tasks:e,done:r}){const i=a=>{for(;(a.timeRemaining()>0||a.didTimeout)&&e.current>0;)t();e.current>0?requestIdleCallback(i):r()};if(typeof requestIdleCallback=="function"&&!requestIdleCallback.clock)requestIdleCallback(i);else{for(;e.current>0;)t();r()}}function le(t,e){return new Promise(r=>{const i={current:t},a=[],n={};function l(){const u={};for(let h=0;h<e.length;h+=1){const d=e[h];if(d.generateData){const f={};if(d.dataGeneratorUniquenessEnabled){let c=n[d.field];c||(c={},n[d.field]=c),f.values=c}u[d.field]=d.generateData(u,f)}}a.push(u),i.current-=1}const s={};e.forEach(u=>{u.hide&&(s[u.field]=!1)}),Ee({work:l,done:()=>r({columns:e,rows:a,initialState:{columns:{columnVisibilityModel:s}}}),tasks:i})})}const vi=(t=!1)=>[{field:"id",generateData:fe,hide:!0},{field:"desk",headerName:"Desk",generateData:Me,width:110},{field:"commodity",headerName:"Commodity",generateData:$e,width:180,editable:t},{field:"traderName",headerName:"Trader Name",generateData:Ue,width:120,editable:t},{field:"traderEmail",headerName:"Trader Email",generateData:ge,renderCell:Fe,width:150,editable:t},{field:"quantity",headerName:"Quantity",type:"number",width:140,generateData:We,editable:t,valueParser:e=>Number(e)},{field:"filledQuantity",headerName:"Filled Quantity",generateData:Be,renderCell:Ot,renderEditCell:li,availableAggregationFunctions:["min","max","avg","size"],type:"number",width:120,editable:t},{field:"isFilled",headerName:"Is Filled",align:"center",generateData:Ve,type:"boolean",width:80,editable:t},{field:"status",headerName:"Status",generateData:qe,renderCell:Qt,renderEditCell:di,type:"singleSelect",valueOptions:ue,width:150,editable:t},{field:"unitPrice",headerName:"Unit Price",generateData:Ge,type:"number",editable:t,valueParser:e=>Number(e)},{field:"unitPriceCurrency",headerName:"Unit Price Currency",generateData:He,renderEditCell:ne,type:"singleSelect",valueOptions:G,width:120,editable:t},{field:"subTotal",headerName:"Sub Total",valueGetter:({row:e})=>e.quantity==null||e.unitPrice==null?null:e.quantity*e.unitPrice,type:"number",width:120},{field:"feeRate",headerName:"Fee Rate",generateData:Ye,type:"number",width:80,editable:t,valueParser:e=>Number(e)},{field:"feeAmount",headerName:"Fee Amount",valueGetter:({row:e})=>e.feeRate==null||e.quantity==null||e.unitPrice==null?null:e.feeRate*e.quantity*e.unitPrice,type:"number",width:120},{field:"incoTerm",generateData:Qe,renderCell:Dt,renderEditCell:ui,type:"singleSelect",valueOptions:ce,editable:t},{field:"totalPrice",headerName:"Total in USD",valueGetter:({row:e})=>e.feeRate==null||e.quantity==null||e.unitPrice==null?null:e.feeRate+e.quantity*e.unitPrice,renderCell:Zt,type:"number",width:160},{field:"pnl",headerName:"PnL",generateData:Ke,renderCell:Et,type:"number",width:140},{field:"maturityDate",headerName:"Maturity Date",generateData:Je,type:"date",editable:t},{field:"tradeDate",headerName:"Trade Date",generateData:Xe,type:"date",editable:t},{field:"brokerId",headerName:"Broker Id",generateData:Ze,hide:!0,editable:t},{field:"brokerName",headerName:"Broker Name",generateData:H,width:140,editable:t},{field:"counterPartyName",headerName:"Counterparty",generateData:H,width:180,editable:t},{field:"counterPartyCountry",headerName:"Counterparty Country",type:"singleSelect",generateData:me,renderCell:Le,valueOptions:Y,valueParser:e=>typeof e=="string"?Y.find(r=>r.value===e):e,valueFormatter:({value:e})=>e==null?void 0:e.label,groupingValueGetter:e=>e.value.code,sortComparator:(e,r,i,a)=>xe(e.label,r.label),editable:t,width:120},{field:"counterPartyCurrency",headerName:"Counterparty Currency",generateData:et,renderEditCell:ne,type:"singleSelect",valueOptions:G,editable:t},{field:"counterPartyAddress",headerName:"Counterparty Address",generateData:tt,width:200,editable:t},{field:"counterPartyCity",headerName:"Counterparty City",generateData:pe,width:120,editable:t},{field:"taxCode",headerName:"Tax Code",generateData:it,type:"singleSelect",valueOptions:rt,editable:t},{field:"contractType",headerName:"Contract Type",generateData:at,type:"singleSelect",valueOptions:st,editable:t},{field:"rateType",headerName:"Rate Type",generateData:nt,type:"singleSelect",valueOptions:lt,editable:t},{field:"lastUpdated",headerName:"Updated on",generateData:ve,type:"dateTime",width:180,editable:t},{field:"dateCreated",headerName:"Created on",generateData:ye,type:"date",width:150,editable:t}],yi=()=>[{field:"id",generateData:fe,hide:!0},{field:"avatar",headerName:"Avatar",generateData:ot,renderCell:wt,valueGetter:t=>t.row.name==null||t.row.avatar==null?null:{name:t.row.name,color:t.row.avatar},sortable:!1,filterable:!1,groupable:!1,aggregable:!1,disableExport:!0},{field:"name",headerName:"Name",generateData:dt,dataGeneratorUniquenessEnabled:!0,width:120,editable:!0,groupable:!1,aggregable:!1},{field:"website",headerName:"Website",generateData:ht,renderCell:_t,width:160,editable:!0,groupable:!1,aggregable:!1},{field:"rating",headerName:"Rating",generateData:ut,renderCell:Pt,renderEditCell:fi,width:180,type:"number",editable:!0,availableAggregationFunctions:["avg","min","max","size"]},{field:"email",headerName:"Email",generateData:ge,renderCell:Fe,width:150,editable:!0},{field:"phone",headerName:"Phone",generateData:ct,width:150,editable:!0},{field:"username",headerName:"Username",generateData:ft,width:150,editable:!0},{field:"city",headerName:"City",generateData:pe,editable:!0},{field:"country",headerName:"Country",type:"singleSelect",valueOptions:Y,valueFormatter:({value:t})=>t==null?void 0:t.label,generateData:me,renderCell:Le,renderEditCell:pi,sortComparator:(t,e,r,i)=>xe(t.label,e.label),width:150,editable:!0},{field:"company",headerName:"Company",generateData:H,width:180,editable:!0},{field:"position",headerName:"Position",generateData:gt,width:180,editable:!0},{field:"lastUpdated",headerName:"Updated on",generateData:ve,type:"dateTime",width:180,editable:!0},{field:"dateCreated",headerName:"Created on",generateData:ye,type:"date",width:120,editable:!0},{field:"isAdmin",headerName:"Is admin?",generateData:mt,type:"boolean",width:150,editable:!0},{field:"salary",headerName:"Salary",generateData:()=>pt(3e4,8e4),type:"number",valueFormatter:({value:t})=>!t||typeof t!="number"?t:`${t.toLocaleString()}$`}],I=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,xi=typeof AbortController=="function",j=xi?AbortController:class{constructor(){this.signal=new Ae}abort(e=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||e,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},bi=typeof AbortSignal=="function",wi=typeof j.AbortSignal=="function",Ae=bi?AbortSignal:wi?j.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(e){e.type==="abort"&&(this.aborted=!0,this.onabort(e),this._listeners.forEach(r=>r(e),this))}onabort(){}addEventListener(e,r){e==="abort"&&this._listeners.push(r)}removeEventListener(e,r){e==="abort"&&(this._listeners=this._listeners.filter(i=>i!==r))}},ae=new Set,W=(t,e)=>{const r=`LRU_CACHE_OPTION_${t}`;R(r)&&se(r,`${t} option`,`options.${e}`,L)},B=(t,e)=>{const r=`LRU_CACHE_METHOD_${t}`;if(R(r)){const{prototype:i}=L,{get:a}=Object.getOwnPropertyDescriptor(i,t);se(r,`${t} method`,`cache.${e}()`,a)}},Ci=(t,e)=>{const r=`LRU_CACHE_PROPERTY_${t}`;if(R(r)){const{prototype:i}=L,{get:a}=Object.getOwnPropertyDescriptor(i,t);se(r,`${t} property`,`cache.${e}`,a)}},Ne=(...t)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...t):console.error(...t)},R=t=>!ae.has(t),se=(t,e,r,i)=>{ae.add(t);const a=`The ${e} is deprecated. Please use ${r} instead.`;Ne(a,"DeprecationWarning",t,i)},T=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),ze=t=>T(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?O:null:null;class O extends Array{constructor(e){super(e),this.fill(0)}}class Si{constructor(e){if(e===0)return[];const r=ze(e);this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class L{constructor(e={}){const{max:r=0,ttl:i,ttlResolution:a=1,ttlAutopurge:n,updateAgeOnGet:l,updateAgeOnHas:s,allowStale:u,dispose:h,disposeAfter:d,noDisposeOnSet:f,noUpdateTTL:c,maxSize:g=0,maxEntrySize:x=0,sizeCalculation:p,fetchMethod:m,fetchContext:b,noDeleteOnFetchRejection:w,noDeleteOnStaleGet:S,allowStaleOnFetchRejection:C,allowStaleOnFetchAbort:E,ignoreFetchAbort:k}=e,{length:A,maxAge:N,stale:z}=e instanceof L?{}:e;if(r!==0&&!T(r))throw new TypeError("max option must be a nonnegative integer");const M=r?ze(r):Array;if(!M)throw new Error("invalid max value: "+r);if(this.max=r,this.maxSize=g,this.maxEntrySize=x||this.maxSize,this.sizeCalculation=p||A,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=m||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=b,!this.fetchMethod&&b!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(r).fill(null),this.valList=new Array(r).fill(null),this.next=new M(r),this.prev=new M(r),this.head=0,this.tail=0,this.free=new Si(r),this.initialFill=1,this.size=0,typeof h=="function"&&(this.dispose=h),typeof d=="function"?(this.disposeAfter=d,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!f,this.noUpdateTTL=!!c,this.noDeleteOnFetchRejection=!!w,this.allowStaleOnFetchRejection=!!C,this.allowStaleOnFetchAbort=!!E,this.ignoreFetchAbort=!!k,this.maxEntrySize!==0){if(this.maxSize!==0&&!T(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!T(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!u||!!z,this.noDeleteOnStaleGet=!!S,this.updateAgeOnGet=!!l,this.updateAgeOnHas=!!s,this.ttlResolution=T(a)||a===0?a:1,this.ttlAutopurge=!!n,this.ttl=i||N||0,this.ttl){if(!T(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const $="LRU_CACHE_UNBOUNDED";R($)&&(ae.add($),Ne("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",$,L))}z&&W("stale","allowStale"),N&&W("maxAge","ttl"),A&&W("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new O(this.max),this.starts=new O(this.max),this.setItemTTL=(i,a,n=I.now())=>{if(this.starts[i]=a!==0?n:0,this.ttls[i]=a,a!==0&&this.ttlAutopurge){const l=setTimeout(()=>{this.isStale(i)&&this.delete(this.keyList[i])},a+1);l.unref&&l.unref()}},this.updateItemAge=i=>{this.starts[i]=this.ttls[i]!==0?I.now():0},this.statusTTL=(i,a)=>{i&&(i.ttl=this.ttls[a],i.start=this.starts[a],i.now=e||r(),i.remainingTTL=i.now+i.ttl-i.start)};let e=0;const r=()=>{const i=I.now();if(this.ttlResolution>0){e=i;const a=setTimeout(()=>e=0,this.ttlResolution);a.unref&&a.unref()}return i};this.getRemainingTTL=i=>{const a=this.keyMap.get(i);return a===void 0?0:this.ttls[a]===0||this.starts[a]===0?1/0:this.starts[a]+this.ttls[a]-(e||r())},this.isStale=i=>this.ttls[i]!==0&&this.starts[i]!==0&&(e||r())-this.starts[i]>this.ttls[i]}updateItemAge(e){}statusTTL(e,r){}setItemTTL(e,r,i){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new O(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,r,i,a)=>{if(this.isBackgroundFetch(r))return 0;if(!T(i))if(a){if(typeof a!="function")throw new TypeError("sizeCalculation must be a function");if(i=a(r,e),!T(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i},this.addItemSize=(e,r,i)=>{if(this.sizes[e]=r,this.maxSize){const a=this.maxSize-this.sizes[e];for(;this.calculatedSize>a;)this.evict(!0)}this.calculatedSize+=this.sizes[e],i&&(i.entrySize=r,i.totalCalculatedSize=this.calculatedSize)}}removeItemSize(e){}addItemSize(e,r){}requireSize(e,r,i,a){if(i||a)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.tail;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.head));)r=this.prev[r]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.head;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.tail));)r=this.next[r]}isValidIndex(e){return e!==void 0&&this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())this.valList[e]!==void 0&&this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield[this.keyList[e],this.valList[e]])}*rentries(){for(const e of this.rindexes())this.valList[e]!==void 0&&this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield[this.keyList[e],this.valList[e]])}*keys(){for(const e of this.indexes())this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.keyList[e])}*rkeys(){for(const e of this.rindexes())this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.keyList[e])}*values(){for(const e of this.indexes())this.valList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.valList[e])}*rvalues(){for(const e of this.rindexes())this.valList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.valList[e])}[Symbol.iterator](){return this.entries()}find(e,r){for(const i of this.indexes()){const a=this.valList[i],n=this.isBackgroundFetch(a)?a.__staleWhileFetching:a;if(n!==void 0&&e(n,this.keyList[i],this))return this.get(this.keyList[i],r)}}forEach(e,r=this){for(const i of this.indexes()){const a=this.valList[i],n=this.isBackgroundFetch(a)?a.__staleWhileFetching:a;n!==void 0&&e.call(r,n,this.keyList[i],this)}}rforEach(e,r=this){for(const i of this.rindexes()){const a=this.valList[i],n=this.isBackgroundFetch(a)?a.__staleWhileFetching:a;n!==void 0&&e.call(r,n,this.keyList[i],this)}}get prune(){return B("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const r of this.rindexes({allowStale:!0}))this.isStale(r)&&(this.delete(this.keyList[r]),e=!0);return e}dump(){const e=[];for(const r of this.indexes({allowStale:!0})){const i=this.keyList[r],a=this.valList[r],n=this.isBackgroundFetch(a)?a.__staleWhileFetching:a;if(n===void 0)continue;const l={value:n};if(this.ttls){l.ttl=this.ttls[r];const s=I.now()-this.starts[r];l.start=Math.floor(Date.now()-s)}this.sizes&&(l.size=this.sizes[r]),e.unshift([i,l])}return e}load(e){this.clear();for(const[r,i]of e){if(i.start){const a=Date.now()-i.start;i.start=I.now()-a}this.set(r,i.value,i)}}dispose(e,r,i){}set(e,r,{ttl:i=this.ttl,start:a,noDisposeOnSet:n=this.noDisposeOnSet,size:l=0,sizeCalculation:s=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,status:h}={}){if(l=this.requireSize(e,r,l,s),this.maxEntrySize&&l>this.maxEntrySize)return h&&(h.set="miss",h.maxEntrySizeExceeded=!0),this.delete(e),this;let d=this.size===0?void 0:this.keyMap.get(e);if(d===void 0)d=this.newIndex(),this.keyList[d]=e,this.valList[d]=r,this.keyMap.set(e,d),this.next[this.tail]=d,this.prev[d]=this.tail,this.tail=d,this.size++,this.addItemSize(d,l,h),h&&(h.set="add"),u=!1;else{this.moveToTail(d);const f=this.valList[d];if(r!==f){if(this.isBackgroundFetch(f)?f.__abortController.abort(new Error("replaced")):n||(this.dispose(f,e,"set"),this.disposeAfter&&this.disposed.push([f,e,"set"])),this.removeItemSize(d),this.valList[d]=r,this.addItemSize(d,l,h),h){h.set="replace";const c=f&&this.isBackgroundFetch(f)?f.__staleWhileFetching:f;c!==void 0&&(h.oldValue=c)}}else h&&(h.set="update")}if(i!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),u||this.setItemTTL(d,i,a),this.statusTTL(h,d),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const r=this.head,i=this.keyList[r],a=this.valList[r];return this.isBackgroundFetch(a)?a.__abortController.abort(new Error("evicted")):(this.dispose(a,i,"evict"),this.disposeAfter&&this.disposed.push([a,i,"evict"])),this.removeItemSize(r),e&&(this.keyList[r]=null,this.valList[r]=null,this.free.push(r)),this.head=this.next[r],this.keyMap.delete(i),this.size--,r}has(e,{updateAgeOnHas:r=this.updateAgeOnHas,status:i}={}){const a=this.keyMap.get(e);if(a!==void 0)if(this.isStale(a))i&&(i.has="stale",this.statusTTL(i,a));else return r&&this.updateItemAge(a),i&&(i.has="hit"),this.statusTTL(i,a),!0;else i&&(i.has="miss");return!1}peek(e,{allowStale:r=this.allowStale}={}){const i=this.keyMap.get(e);if(i!==void 0&&(r||!this.isStale(i))){const a=this.valList[i];return this.isBackgroundFetch(a)?a.__staleWhileFetching:a}}backgroundFetch(e,r,i,a){const n=r===void 0?void 0:this.valList[r];if(this.isBackgroundFetch(n))return n;const l=new j;i.signal&&i.signal.addEventListener("abort",()=>l.abort(i.signal.reason));const s={signal:l.signal,options:i,context:a},u=(g,x=!1)=>{const{aborted:p}=l.signal,m=i.ignoreFetchAbort&&g!==void 0;return i.status&&(p&&!x?(i.status.fetchAborted=!0,i.status.fetchError=l.signal.reason,m&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),p&&!m&&!x?d(l.signal.reason):(this.valList[r]===c&&(g===void 0?c.__staleWhileFetching?this.valList[r]=c.__staleWhileFetching:this.delete(e):(i.status&&(i.status.fetchUpdated=!0),this.set(e,g,s.options))),g)},h=g=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=g),d(g)),d=g=>{const{aborted:x}=l.signal,p=x&&i.allowStaleOnFetchAbort,m=p||i.allowStaleOnFetchRejection,b=m||i.noDeleteOnFetchRejection;if(this.valList[r]===c&&(!b||c.__staleWhileFetching===void 0?this.delete(e):p||(this.valList[r]=c.__staleWhileFetching)),m)return i.status&&c.__staleWhileFetching!==void 0&&(i.status.returnedStale=!0),c.__staleWhileFetching;if(c.__returned===c)throw g},f=(g,x)=>{this.fetchMethod(e,n,s).then(p=>g(p),x),l.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(g(),i.allowStaleOnFetchAbort&&(g=p=>u(p,!0)))})};i.status&&(i.status.fetchDispatched=!0);const c=new Promise(f).then(u,h);return c.__abortController=l,c.__staleWhileFetching=n,c.__returned=null,r===void 0?(this.set(e,c,{...s.options,status:void 0}),r=this.keyMap.get(e)):this.valList[r]=c,c}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:a=this.noDeleteOnStaleGet,ttl:n=this.ttl,noDisposeOnSet:l=this.noDisposeOnSet,size:s=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:c=this.ignoreFetchAbort,allowStaleOnFetchAbort:g=this.allowStaleOnFetchAbort,fetchContext:x=this.fetchContext,forceRefresh:p=!1,status:m,signal:b}={}){if(!this.fetchMethod)return m&&(m.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:a,status:m});const w={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:a,ttl:n,noDisposeOnSet:l,size:s,sizeCalculation:u,noUpdateTTL:h,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:g,ignoreFetchAbort:c,status:m,signal:b};let S=this.keyMap.get(e);if(S===void 0){m&&(m.fetch="miss");const C=this.backgroundFetch(e,S,w,x);return C.__returned=C}else{const C=this.valList[S];if(this.isBackgroundFetch(C)){const z=r&&C.__staleWhileFetching!==void 0;return m&&(m.fetch="inflight",z&&(m.returnedStale=!0)),z?C.__staleWhileFetching:C.__returned=C}const E=this.isStale(S);if(!p&&!E)return m&&(m.fetch="hit"),this.moveToTail(S),i&&this.updateItemAge(S),this.statusTTL(m,S),C;const k=this.backgroundFetch(e,S,w,x),A=k.__staleWhileFetching!==void 0,N=A&&r;return m&&(m.fetch=A&&E?"stale":"refresh",N&&E&&(m.returnedStale=!0)),N?k.__staleWhileFetching:k.__returned=k}}get(e,{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:a=this.noDeleteOnStaleGet,status:n}={}){const l=this.keyMap.get(e);if(l!==void 0){const s=this.valList[l],u=this.isBackgroundFetch(s);return this.statusTTL(n,l),this.isStale(l)?(n&&(n.get="stale"),u?(n&&(n.returnedStale=r&&s.__staleWhileFetching!==void 0),r?s.__staleWhileFetching:void 0):(a||this.delete(e),n&&(n.returnedStale=r),r?s:void 0)):(n&&(n.get="hit"),u?s.__staleWhileFetching:(this.moveToTail(l),i&&this.updateItemAge(l),s))}else n&&(n.get="miss")}connect(e,r){this.prev[r]=e,this.next[e]=r}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return B("del","delete"),this.delete}delete(e){let r=!1;if(this.size!==0){const i=this.keyMap.get(e);if(i!==void 0)if(r=!0,this.size===1)this.clear();else{this.removeItemSize(i);const a=this.valList[i];this.isBackgroundFetch(a)?a.__abortController.abort(new Error("deleted")):(this.dispose(a,e,"delete"),this.disposeAfter&&this.disposed.push([a,e,"delete"])),this.keyMap.delete(e),this.keyList[i]=null,this.valList[i]=null,i===this.tail?this.tail=this.prev[i]:i===this.head?this.head=this.next[i]:(this.next[this.prev[i]]=this.next[i],this.prev[this.next[i]]=this.prev[i]),this.size--,this.free.push(i)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return r}clear(){for(const e of this.rindexes({allowStale:!0})){const r=this.valList[e];if(this.isBackgroundFetch(r))r.__abortController.abort(new Error("deleted"));else{const i=this.keyList[e];this.dispose(r,i,"delete"),this.disposeAfter&&this.disposed.push([r,i,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return B("reset","clear"),this.clear}get length(){return Ci("length","size"),this.size}static get AbortController(){return j}static get AbortSignal(){return Ae}}const oe=(t,e={})=>{var r;const{averageChildren:i=2,maxDepth:a=1,groupingField:n}=e;if(!(a>1&&n!=null))return y({},t,{experimentalFeatures:{ariaV7:!0}});if(t.rows.length>1e3)throw new Error("MUI: useDemoData tree data mode only works up to 1000 rows.");const s={},u=t.rows.length,h=t.columns.find(d=>d.field===e.groupingField);if(!h)throw new Error("MUI: The tree data grouping field does not exist");t.initialState.columns.columnVisibilityModel[n]=!1;for(let d=0;d<u;d+=1){const f=t.rows[d],c=Math.floor(d*(i**a-1)/u)+1,g=Math.floor(Math.log(c)/Math.log(i));s[g]||(s[g]={rows:{},rowIndexes:[]}),s[g].rows[d]={value:f,parentIndex:null},s[g].rowIndexes.push(d)}return Object.entries(s).forEach(([d,{rows:f}])=>{const c=Number(d);Object.values(f).forEach(g=>{const x=[];let p=null;for(let m=c;m>=0;m-=1){let b;m===c?(c>0&&(g.parentIndex=Number(vt(s[c-1].rowIndexes))),b=g):b=s[m].rows[p.parentIndex],x.unshift(b.value[n]),p=b}g.value.path=x})}),y({},t,{groupingColDef:{headerName:(r=h.headerName)!=null?r:h.field,width:250},getTreeDataPath:d=>d.path,treeData:!0,experimentalFeatures:{ariaV7:!0}})},V=new L({max:10,ttl:60*5*1e3});async function _i(t,e){return new Promise(r=>{const i=e.rows,a=e.rows.slice(),n={current:t-i.length};function l(){const s={};for(let u=0;u<e.columns.length;u+=1){const h=e.columns[u],d=Math.round(Math.random()*(i.length-1));h.field==="id"?s.id=`id-${n.current+i.length}`:s[h.field]=i[d][h.field]}a.push(s),n.current-=1}Ee({work:l,done:()=>r(y({},e,{rows:a})),tasks:n})})}const Ti=t=>{let e=t.dataSet==="Commodity"?vi(t.editable):yi();return t.visibleFields&&(e=e.map(r=>{var i;return(i=t.visibleFields)!=null&&i.includes(r.field)?r:y({},r,{hide:!0})})),t.maxColumns&&(e=e.slice(0,t.maxColumns)),e},Di=(t,e)=>{var r;const i={};e.forEach(n=>{n.hide&&(i[n.field]=!1)});const a=(r=t.treeData)==null?void 0:r.groupingField;return a&&(i[a]=!1),{columns:{columnVisibilityModel:i}}},$i=t=>{var e,r,i;const[a,n]=v.useState(t.rowLength),[l,s]=v.useState(0),[u,h]=v.useState(!0),d=v.useMemo(()=>Ti({dataSet:t.dataSet,editable:t.editable,maxColumns:t.maxColumns,visibleFields:t.visibleFields}),[t.dataSet,t.editable,t.maxColumns,t.visibleFields]),[f,c]=v.useState(()=>oe({columns:d,rows:[],initialState:Di(t,d)},t.treeData));return v.useEffect(()=>{const g=`${t.dataSet}-${a}-${l}-${t.maxColumns}`;if(V.has(g)){const p=V.get(g);c(p),h(!1);return}let x=!0;return(async(p,m,b)=>{h(!0);let w;a>1e3?(w=await le(1e3,d),w=await _i(a,w)):w=await le(a,d),x&&(w=oe(w,{maxDepth:(p=t.treeData)==null?void 0:p.maxDepth,groupingField:(m=t.treeData)==null?void 0:m.groupingField,averageChildren:(b=t.treeData)==null?void 0:b.averageChildren}),V.set(g,w),c(w),h(!1))})(),()=>{x=!1}},[a,t.dataSet,t.maxColumns,(e=t.treeData)==null?void 0:e.maxDepth,(r=t.treeData)==null?void 0:r.groupingField,(i=t.treeData)==null?void 0:i.averageChildren,l,d]),{data:f,loading:u,setRowLength:n,loadNewData:()=>{s(g=>g+1)}}};export{$i as u};
