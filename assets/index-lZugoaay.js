import{P as I,M as R,bf as S,am as w,l as e,T as D,bo as te,z as F,r as y,S as O,D as re,aj as se,O as W,I as ne,J as oe,Y as M,bj as ae,bk as ie,bh as z,be as _,G as x,F as k,aW as le,bi as de,a1 as ce,bp as pe,$ as U,bq as ue,K as me,br as he,bs as xe}from"./index-aYNdDFsw.js";import{P as q,A as ge,d as fe,E as be,C as H,D as je,I as ye}from"./ItemDetails-COHE7bMD.js";import{O as Ce}from"./OutlinedInput-CX89FYVG.js";import{g as ke,I as Ie}from"./getImageUrl-CsHsmFJf.js";import{d as De}from"./MoreVertTwoTone-Frh2cjOq.js";import{M as Se}from"./Menu-BcGYJvIj.js";import{M as K}from"./MenuItem-BtCOIvr_.js";import{T as B}from"./Tooltip-DeGY6c7u.js";import{S as X}from"./SubCard-DNvCAQ00.js";import{d as we}from"./CalendarTodayTwoTone-CdtAoUMy.js";import{d as Te}from"./PeopleAltTwoTone-CAr3hWDH.js";import{T as N}from"./TextField-DGRzrz84.js";import{_ as ve}from"./typeof-QjJsDpFa.js";import{a as Ae,b as Oe}from"./AdapterDateFns-DdGwa7T7.js";import{r as $,t as C}from"./index-DhB-ElUn.js";import{D as Re,a as ze}from"./DialogContent-v1P_Pn4u.js";import{D as Me}from"./DialogTitle-B_68QVU1.js";import{D as We}from"./DialogContentText-rEL4-FoX.js";import{D as $e}from"./DialogActions-DE2c5d4J.js";import{d as Pe}from"./DeleteTwoTone-BKDxg_KV.js";import"./index.esm-Cs06t5W7.js";import"./formik.esm-BnGHO-0j.js";import"./isArrayLike-C-wli46Q.js";import"./_getTag-D0Y4uZ2p.js";import"./isSymbol-ckKrFcy_.js";import"./MultiFile-CSf-j01a.js";import"./InsertDriveFileOutlined-94OlvQ7p.js";import"./ListItem-C7PTSiU0.js";import"./ListItemSecondaryAction-BoxADv29.js";import"./FiberManualRecord-BmuosE1o.js";import"./dateViewRenderers-DtPWu7er.js";import"./InputAdornment-P1yKTSAa.js";import"./Autocomplete-DiVzDCrp.js";import"./Select-DVXOMGOZ.js";import"./utils-DoM3o7-Q.js";import"./InputBase-DT8iEGhH.js";import"./ListSubheader-DJmmTOtu.js";import"./usePreviousProps-BFuD_vnI.js";import"./FormControl-Dj_1sEpm.js";import"./DesktopDatePicker-D67ugVtj.js";import"./useDesktopPicker-D5r1bgKN.js";import"./InputLabel-taUurEu1.js";import"./FormLabel-CLieAm2i.js";import"./FormHelperText-C1AdVjvj.js";import"./toPropertyKey-H7AvS4qg.js";function Ee(r,t){$(2,arguments);var s=C(t);return Ae(r,-s)}function Ke(r,t){$(2,arguments);var s=C(t);return Oe(r,-s)}function Be(r,t){if($(2,arguments),!t||ve(t)!=="object")return new Date(NaN);var s=t.years?C(t.years):0,c=t.months?C(t.months):0,n=t.weeks?C(t.weeks):0,m=t.days?C(t.days):0,h=t.hours?C(t.hours):0,l=t.minutes?C(t.minutes):0,f=t.seconds?C(t.seconds):0,b=Ke(r,c+s*12),p=Ee(b,m+n*7),g=l+h*60,d=f+g*60,o=d*1e3,a=new Date(p.getTime()-o);return a}const G=({column:r})=>{const t=R(),s=S(),{columns:c}=w(m=>m.kanban),n=m=>{s(te({id:r.id,title:m.target.value,itemIds:r.itemIds},c))};return e.jsx(Ce,{fullWidth:!0,value:r.title,onChange:n,sx:{mb:1.5,"& input:focus":{bgcolor:t.palette.mode===D.DARK?"dark.800":"grey.50"},"& input:hover":{bgcolor:t.palette.mode===D.DARK?"dark.800":"grey.50"},"& input:hover + fieldset":{display:"block"},"&, & input":{bgcolor:"transparent"},"& fieldset":{display:"none"},"& input:focus + fieldset":{display:"block"}},placeholder:"title"})};G.propTypes={column:I.object};const Fe=(r,t,s,c)=>{const n=s.palette.mode===D.DARK?M(s.palette.background.paper,.9):s.palette.grey[50];return{userSelect:"none",margin:"0 0 8px 0",padding:16,border:"1px solid",borderColor:s.palette.mode===D.DARK?s.palette.background.default:M(s.palette.primary[200],.75),backgroundColor:r?n:s.palette.background.paper,borderRadius:c,...t}},L=({item:r,index:t})=>{const s=R(),c=S(),n=r.image&&ke(`${r.image}`,Ie.PROFILE),{borderRadius:m}=F(),h=w(u=>u.kanban),{userStory:l,items:f,columns:b}=h,p=l.filter(u=>{var A;return(A=u==null?void 0:u.itemIds)==null?void 0:A.filter(ee=>ee===r.id)[0]})[0],g=u=>{c(ae(u))},[d,o]=y.useState(null),a=u=>{o(u==null?void 0:u.currentTarget)},i=()=>{o(null)},[j,T]=y.useState(!1),v=u=>{T(!1),u&&(c(ie(r.id,f,b,l)),c(z({open:!0,message:"Task Deleted successfully",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"success"},close:!1})))},[P,E]=y.useState(!1),V=()=>{E(u=>!u)},Z=()=>{E(u=>!u)};return e.jsx(q,{draggableId:r.id,index:t,children:(u,A)=>e.jsxs("div",{ref:u.innerRef,...u.draggableProps,...u.dragHandleProps,style:Fe(A.isDragging,u.draggableProps.style,s,`${m}px`),children:[e.jsxs(O,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:p?-.75:0},children:[e.jsx(re,{onClick:()=>g(r.id),variant:"subtitle1",sx:{display:"inline-block",width:"calc(100% - 34px)",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",verticalAlign:"middle",cursor:"pointer"},children:r.title}),e.jsx(se,{sx:{borderRadius:"12px"},onClick:a,"aria-controls":"menu-comment","aria-haspopup":"true",children:e.jsx(W,{component:"span",size:"small",disableRipple:!0,"aria-label":"more options",children:e.jsx(De,{fontSize:"inherit"})})}),e.jsxs(Se,{id:"menu-comment",anchorEl:d,keepMounted:!0,open:!!d,onClose:i,variant:"selectedMenu",anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsx(K,{onClick:()=>{i(),g(r.id)},children:"Edit"}),e.jsx(K,{onClick:()=>{i(),T(!0)},children:"Delete"})]}),j&&e.jsx(ge,{title:r.title,open:j,handleClose:v})]}),p&&e.jsxs(e.Fragment,{children:[e.jsxs(O,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(B,{title:"User Story",children:e.jsx(fe,{color:"secondary",sx:{fontSize:"0.875rem"}})}),e.jsx(B,{title:p.title,children:e.jsxs(ne,{variant:"caption",color:"secondary",underline:"hover",onClick:Z,sx:{cursor:"pointer",pt:.5},children:["User Story #",p.id]})})]}),P&&e.jsx(be,{story:p,open:P,handleDrawerOpen:V})]}),n&&e.jsx(oe,{component:"img",image:n,sx:{width:"100%",borderRadius:1,mt:1.5},title:"Slider5 image"})]})},r.id)};L.propTypes={index:I.number,item:I.object};const _e=new _.Chance,J=({columnId:r})=>{const t=S(),[s,c]=y.useState(!1),{columns:n,items:m,userStory:h}=w(i=>i.kanban),l=()=>{c(i=>!i)},[f,b]=y.useState(""),[p,g]=y.useState(!1),d=i=>{(i.key==="Enter"||i.keyCode===13)&&o()},o=()=>{if(f.length>0){const i={id:`${_e.integer({min:1e3,max:9999})}`,title:f,dueDate:Be(new Date,{days:0,hours:1,minutes:45}),image:!1,assign:"",description:"",priority:"low",attachments:[]};t(de(r,n,i,m,"0",h)),t(z({open:!0,message:"Task Add successfully",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"success"},close:!1})),l(),b("")}else g(!0)},a=i=>{const j=i.target.value;b(j),j.length<=0?g(!0):g(!1)};return e.jsxs(x,{container:!0,alignItems:"center",spacing:1,sx:{marginTop:1},children:[s&&e.jsx(x,{item:!0,xs:12,children:e.jsx(X,{contentSX:{p:2,transition:"background-color 0.25s ease-out"},children:e.jsxs(x,{container:!0,alignItems:"center",spacing:.5,children:[e.jsx(x,{item:!0,xs:12,children:e.jsx(N,{fullWidth:!0,placeholder:"Add Task",value:f,onChange:a,sx:{mb:2,"& input":{bgcolor:"transparent",p:0,borderRadius:"0px"},"& fieldset":{display:"none"},"& .MuiFormHelperText-root":{ml:0},"& .MuiOutlinedInput-root":{bgcolor:"transparent"}},onKeyUp:d,helperText:p?"Task title is required.":"",error:p})}),e.jsx(x,{item:!0,children:e.jsx(k,{variant:"text",size:"small",color:"primary",sx:{p:.5,minWidth:32},"aria-label":"people",children:e.jsx(Te,{fontSize:"small"})})}),e.jsx(x,{item:!0,children:e.jsx(k,{variant:"text",size:"small",color:"primary",sx:{p:.5,minWidth:32},"aria-label":"calendar",children:e.jsx(we,{fontSize:"small"})})}),e.jsx(x,{item:!0,xs:!0,zeroMinWidth:!0}),e.jsx(x,{item:!0,children:e.jsxs(O,{direction:"row",alignItems:"center",spacing:.5,children:[e.jsx(W,{size:"small",color:"error",onClick:l,"aria-label":"cancel add task",children:e.jsx(le,{fontSize:"small"})}),e.jsx(k,{variant:"contained",color:"primary",onClick:o,size:"small",children:"Add"})]})})]})})}),!s&&e.jsx(x,{item:!0,xs:12,children:e.jsx(k,{variant:"text",color:"primary",sx:{width:"100%"},onClick:l,children:"Add Task"})})]})};J.propTypes={columnId:I.string};function Y({title:r,open:t,handleClose:s}){return e.jsx(Re,{open:t,onClose:()=>s(!1),keepMounted:!0,maxWidth:"xs","aria-labelledby":"column-delete-title","aria-describedby":"column-delete-description",children:t&&e.jsxs(e.Fragment,{children:[e.jsxs(Me,{id:"column-delete-title",children:[r," - Are you sure you want to delete?"]}),e.jsx(ze,{children:e.jsx(We,{id:"column-delete-description",children:"By deleting column, all task inside that column will also be deleted."})}),e.jsxs($e,{sx:{mr:2},children:[e.jsx(k,{onClick:()=>s(!1),color:"error",children:"Cancel"}),e.jsx(k,{variant:"contained",size:"small",onClick:()=>s(!0),autoFocus:!0,children:"Delete"})]})]})})}Y.propTypes={open:I.bool,handleClose:I.func,title:I.string};const Ue=(r,t,s,c)=>{const n=s.palette.mode===D.DARK?s.palette.background.default:s.palette.primary.light;return{minWidth:250,border:"1px solid",borderColor:s.palette.mode===D.DARK?s.palette.background.default:M(s.palette.primary[200],.75),backgroundColor:r?s.palette.grey[50]:n,borderRadius:c,userSelect:"none",margin:"0 16px 0 0",height:"100%",...t}},qe=(r,t,s)=>{const c=t.palette.mode===D.DARK?t.palette.background.default:t.palette.primary.light,n=t.palette.mode===D.DARK?t.palette.text.disabled:t.palette.primary[200];return{background:r?n:c,padding:"8px 16px 14px",width:"auto",borderRadius:s}},Q=({column:r,index:t})=>{const s=R(),c=S(),{borderRadius:n}=F(),{items:m,columns:h,columnsOrder:l}=w(o=>o.kanban),f=r.itemIds.map(o=>m.filter(a=>a.id===o)[0]),b=()=>{g(!0)},[p,g]=y.useState(!1),d=o=>{g(!1),o&&(c(pe(r.id,l,h)),c(z({open:!0,message:"Column deleted successfully",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"success"},close:!1})))};return e.jsx(q,{draggableId:r.id,index:t,children:(o,a)=>e.jsx("div",{ref:o.innerRef,...o.draggableProps,...o.dragHandleProps,style:Ue(a.isDragging,o.draggableProps.style,s,`${n}px`),children:e.jsx(H,{droppableId:r.id,type:"item",children:(i,j)=>e.jsxs("div",{ref:i.innerRef,...i.droppableProps,style:qe(j.isDraggingOver,s,`${n}px`),children:[e.jsxs(x,{container:!0,alignItems:"center",spacing:ce,children:[e.jsx(x,{item:!0,xs:!0,zeroMinWidth:!0,children:e.jsx(G,{column:r})}),e.jsxs(x,{item:!0,sx:{mb:1.5},children:[e.jsx(W,{onClick:b,size:"large","aria-label":"Delete Columns",children:e.jsx(Pe,{fontSize:"small","aria-controls":"menu-simple-card","aria-haspopup":"true"})}),p&&e.jsx(Y,{title:r.title,open:p,handleClose:d})]})]}),f.map((T,v)=>e.jsx(L,{item:T,index:v},v)),i.placeholder,e.jsx(J,{columnId:r.id})]})})})})};Q.propTypes={column:I.object,index:I.number};const He=new _.Chance,Xe=()=>{const r=R(),t=S(),[s,c]=y.useState(""),[n,m]=y.useState(!1),[h,l]=y.useState(!1),{columns:f,columnsOrder:b}=w(a=>a.kanban),p=()=>{l(a=>!a)},g=()=>{if(s.length>0){const a={id:`${He.integer({min:1e3,max:9999})}`,title:s,itemIds:[]};t(ue(a,f,b)),t(z({open:!0,message:"Column Add successfully",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"success"},close:!1})),l(i=>!i),c("")}else m(!0)},d=a=>{(a.key==="Enter"||a.keyCode===13)&&g()},o=a=>{const i=a.target.value;c(i),i.length<=0?m(!0):m(!1)};return e.jsx(U,{sx:{minWidth:250,bgcolor:r.palette.mode===D.DARK?"background.default":"primary.light",height:"100%"},contentSX:{p:1.5,"&:last-of-type":{pb:1.5}},children:e.jsxs(x,{container:!0,alignItems:"center",spacing:1,children:[h&&e.jsx(x,{item:!0,xs:12,children:e.jsx(X,{contentSX:{p:2,transition:"background-color 0.25s ease-out"},children:e.jsxs(x,{container:!0,alignItems:"center",spacing:.5,children:[e.jsx(x,{item:!0,xs:12,children:e.jsx(N,{fullWidth:!0,placeholder:"Add Column",value:s,onChange:o,sx:{mb:2,"& input":{bgcolor:"transparent",p:0,borderRadius:"0px"},"& fieldset":{display:"none"},"& .MuiFormHelperText-root":{ml:0},"& .MuiOutlinedInput-root":{bgcolor:"transparent"}},onKeyUp:d,helperText:n?"Column title is required.":"",error:n})}),e.jsx(x,{item:!0,xs:!0,zeroMinWidth:!0}),e.jsx(x,{item:!0,children:e.jsxs(O,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(k,{variant:"text",color:"error",sx:{width:"100%"},onClick:p,children:"Cancel"}),e.jsx(k,{variant:"contained",color:"primary",onClick:g,size:"small",children:"Add"})]})})]})})}),!h&&e.jsx(x,{item:!0,xs:12,children:e.jsx(k,{variant:"text",color:"primary",sx:{width:"100%"},onClick:p,children:"Add Column"})})]})})},Ne=r=>({p:1,bgcolor:r?"primary.200":"transparent",display:"flex",overflow:"auto"}),Kt=()=>{const r=S(),{columns:t,columnsOrder:s}=w(n=>n.kanban),c=n=>{let m;const{source:h,destination:l,draggableId:f,type:b}=n;if(!l||l.droppableId===h.droppableId&&l.index===h.index)return;if(b==="column"){const d=Array.from(s);d.splice(h.index,1),d.splice(l==null?void 0:l.index,0,f),r(he(d));return}const p=t.filter(d=>d.id===h.droppableId)[0],g=t.filter(d=>d.id===l.droppableId)[0];if(p===g){const d=Array.from(p.itemIds);d.splice(h.index,1),d.splice(l.index,0,f);const o={...p,itemIds:d};m=t.map(a=>a.id===o.id?o:a)}else{const d=Array.from(p.itemIds);d.splice(h.index,1);const o={...p,itemIds:d},a=Array.from(g.itemIds);a.splice(l.index,0,f);const i={...g,itemIds:a};m=t.map(j=>j.id===o.id?o:j.id===i.id?i:j)}r(xe(m))};return e.jsxs(me,{sx:{display:"flex"},children:[e.jsx(je,{onDragEnd:c,children:e.jsx(H,{droppableId:"columns",direction:"horizontal",type:"column",children:(n,m)=>e.jsxs(U,{border:!1,ref:n.innerRef,contentSX:Ne(m.isDraggingOver),...n.droppableProps,children:[s.map((h,l)=>{const f=t.filter(b=>b.id===h)[0];return e.jsx(Q,{column:f,index:l},h)}),n.placeholder,e.jsx(Xe,{})]})})}),e.jsx(ye,{})]})};export{Kt as default};
