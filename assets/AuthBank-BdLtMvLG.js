import{M as O,aC as J,bf as L,a5 as m,al as U,r as D,l as e,G as _,ae as R,D as S,L as z,K as g,E as N,F as B,a4 as M}from"./index-D8YYVO5u.js";import{F as $}from"./formik.esm-CGqp9kK7.js";import{c as G,a as u}from"./index.esm-BhdfoqDM.js";import{u as X}from"./useScriptRef-CqXfyK28.js";import{s as H,a as K}from"./password-strength-DOPTROk5.js";import{S as Q}from"./swal-B5TtDhE4.js";import{b as w,a as Y}from"./branches-DNXF9m6l.js";import{F as d}from"./FormControl-CK8irnJG.js";import{I as h}from"./InputLabel-D3KD0Tiy.js";import{O as j}from"./OutlinedInput-DWLv5J1V.js";import{F as c}from"./FormHelperText-J-lHncki.js";import{S as P}from"./Select-BCrvOGUu.js";import{M as v}from"./MenuItem-BsENe2oa.js";import{C as Z}from"./Checkbox-CEnLEK7F.js";const fe=({...F})=>{const l=O(),k=J();X(),L();const p=Q.mixin({toast:!0,position:"top-start",iconColor:"white",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:3500,timerProgressBar:!0}),[A,ee]=m.useState(!1),[C,T]=m.useState(!1),[y,x]=m.useState(!1),[te,q]=m.useState(0),[ne,W]=m.useState(),{addBankAccountDetails:E}=U(),V=async()=>{try{x(!0);const t=JSON.parse(localStorage.getItem("tempUser")),a=await fetch(M.apiUrl+"api/referral/add-bank-account-details-skip",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await a.json();if(a.ok)p.fire({icon:"success",title:"Verification Code Sent!"}),x(!1),k("/register/code-verification",{replace:!0});else throw x(!1),new Error(o.error)}catch(t){console.error(t),console.log("sanu error",t.message),p.fire({icon:"error",title:t.message}),x(!1)}},I=t=>{const a=H(t);q(a),W(K(a))};return D.useEffect(()=>{I("123456"),console.log(w)},[]),e.jsx(e.Fragment,{children:e.jsx($,{initialValues:{account_name:"",account_number:"",bank_name:"",branch:"",NIC:"",submit:null},validationSchema:G().shape({account_name:u().max(255).required("Account name is required"),account_number:u().max(100,"Account number must be 100 characters").required("Account number is required"),bank_name:u().required("Please select the bank name"),branch:u().required("Please select the bank branch"),NIC:u().matches(/^(?:\d{9}[vVxX]|\d{12})$/,"NIC should either contain 9 digits with an optional last character as a letter (v/V/x/X) or have exactly 12 digits").required("NIC is required")}),onSubmit:async(t,{setErrors:a,setStatus:o,setSubmitting:b})=>{try{const s=JSON.parse(localStorage.getItem("tempUser"));if(!C){o({success:!1}),a({submit:"Please agree with terms and conditions"}),b(!1);return}t={...s,...t},console.log("Verification code sent to your account:",t);const r=await E(t);r&&(console.log(r),console.log("sanu"),p.fire({icon:"success",title:"Bank Details Added Successfully. Verification Code Sent!"}),k("/register/code-verification",{replace:!0}))}catch(s){console.error(s),p.fire({icon:"error",title:s.message}),o({success:!1}),b(!1)}},children:({errors:t,handleBlur:a,handleChange:o,handleSubmit:b,isSubmitting:s,touched:r,values:i})=>e.jsxs("form",{noValidate:!0,onSubmit:b,...F,children:[e.jsxs(d,{fullWidth:!0,error:!!(r.account_name&&t.account_name),sx:{...l.typography.customInput},children:[e.jsx(h,{htmlFor:"outlined-adornment-account-name",children:"Account name"}),e.jsx(j,{id:"outlined-adornment-account-name",type:"text",value:i.account_name,name:"account_name",onBlur:a,onChange:o,inputProps:{}}),r.account_name&&t.account_name&&e.jsx(c,{error:!0,id:"standard-weight-helper-text-account-name",children:t.account_name})]}),e.jsxs(d,{fullWidth:!0,error:!!(r.account_number&&t.account_number),sx:{...l.typography.customInput},children:[e.jsx(h,{htmlFor:"outlined-adornment-account-no",children:"Account number"}),e.jsx(j,{id:"outlined-adornment-account-no",type:"text",value:i.account_number,name:"account_number",onBlur:a,onChange:o,inputProps:{}}),r.account_number&&t.account_number&&e.jsx(c,{error:!0,id:"standard-weight-helper-text-account-no",children:t.account_no})]}),e.jsxs(d,{fullWidth:!0,error:!!(r.bank_name&&t.bank_name),sx:{...l.typography.customInput},size:"medium",children:[e.jsx(h,{htmlFor:"outlined-adornment-bank-name",children:"Bank name"}),e.jsx(P,{id:"outlined-adornment-bank-name",value:i.bank_name,name:"bank_name",onBlur:a,onChange:o,inputProps:{},style:{height:"60px",paddingTop:"17px"},children:w.slice().sort((n,f)=>n.ProductParticipation.localeCompare(f.ProductParticipation)).map(n=>e.jsx(v,{value:n.BankName,children:n.ProductParticipation},n.BankName))}),r.bank_name&&t.bank_name&&e.jsx(c,{error:!0,id:"standard-weight-helper-text-bank-name",children:t.bank_name})]}),e.jsxs(d,{fullWidth:!0,error:!!(r.branch&&t.branch),sx:{...l.typography.customInput},children:[e.jsx(h,{htmlFor:"outlined-adornment-bank-branch",children:"Bank branch"}),e.jsx(P,{id:"outlined-adornment-bank-branch",value:i.branch,name:"branch",onBlur:a,onChange:o,inputProps:{},style:{height:"60px",paddingTop:"17px"},children:Y.filter(n=>n.BankCode===i.bank_name).slice().sort((n,f)=>n.BranchName.localeCompare(f.BranchName)).map(n=>e.jsx(v,{value:n.BranchName,children:n.BranchName},n.BranchCode))}),r.branch&&t.branch&&e.jsx(c,{error:!0,id:"standard-weight-helper-text-bank-branch",children:t.branch})]}),e.jsxs(d,{fullWidth:!0,error:!!(r.NIC&&t.NIC),sx:{...l.typography.customInput},children:[e.jsx(h,{htmlFor:"outlined-adornment-NIC",children:"NIC"}),e.jsx(j,{id:"outlined-adornment-NIC",type:"text",value:i.NIC,name:"NIC",onBlur:a,onChange:n=>{o(n),I(n.target.value)},inputProps:{}}),r.NIC&&t.NIC&&e.jsx(c,{error:!0,id:"standard-weight-helper-text-NIC",children:t.NIC})]}),e.jsx(_,{container:!0,alignItems:"center",justifyContent:"space-between",children:e.jsx(_,{item:!0,children:e.jsx(R,{control:e.jsx(Z,{checked:C,onChange:n=>T(n.target.checked),name:"checked",color:"primary"}),label:e.jsxs(S,{variant:"subtitle1",children:["Agree with Â ",e.jsx(S,{variant:"subtitle1",component:z,to:"#",children:"Terms & Condition."})]})})})}),t.submit&&e.jsx(g,{sx:{mt:3},children:e.jsx(c,{error:!0,children:t.submit})}),e.jsx(g,{sx:{mt:2},children:e.jsx(N,{children:e.jsx(B,{disableElevation:!0,disabled:s||y,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"secondary",children:"Complete"})})}),e.jsx(g,{sx:{mt:2},children:e.jsx(N,{children:e.jsx(B,{disableElevation:!0,disabled:s||y,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",onClick:V,children:"Skip"})})})]})})})};export{fe as J};
